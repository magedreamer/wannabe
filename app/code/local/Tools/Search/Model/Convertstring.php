<?php
class Tools_Search_Model_ConvertString extends Mage_Core_Model_Abstract
{	
    protected $str='';
    protected $attr='';
    protected $_ishow=0;
    protected $_utf8 = array(
           "ạ","á","à","ả","ã","Ạ","Á","À","Ả","Ã",
           "â","ậ","ấ","ầ","ẩ","ẫ","Â","Ậ","Ấ","Ầ","Ẩ","Ẫ",
           "ă","ặ","ắ","ằ","ẳ","ẫ","Ă","Ắ","Ằ","Ẳ","Ẵ","Ặ",
           "ê","ẹ","é","è","ẻ","ẽ","Ê","Ẹ","É","È","Ẻ","Ẽ",
           "ế","ề","ể","ễ","ệ","Ế","Ề","Ể","Ễ","Ệ",
           "ọ","ộ","ổ","ỗ","ố","ồ","Ọ","Ộ","Ổ","Ỗ","Ố","Ồ","Ô","ô",
           "ó","ò","ỏ","õ","Ó","Ò","Ỏ","Õ",
           "ơ","ợ","ớ","ờ","ở","ỡ",
           "Ơ","Ợ","Ớ","Ờ","Ở","Ỡ",
           "ụ","ư","ứ","ừ","ử","ữ","ự","Ụ","Ư","Ứ","Ừ","Ử","Ữ","Ự",
           "ú","ù","ủ","ũ","Ú","Ù","Ủ","Ũ",
           "ị","í","ì","ỉ","ĩ","Ị","Í","Ì","Ỉ","Ĩ",
           "ỵ","ý","ỳ","ỷ","ỹ","Ỵ","Ý","Ỳ","Ỷ","Ỹ",
           "đ","Đ"
           );

    protected $_utf8_upper = array(
           "Ạ","Á","À","Ả","Ã","Â","Ậ","Ấ","Ầ","Ẩ","Ẫ","Ă","Ặ","Ắ","Ằ","Ẳ","Ẵ",
           "Ẹ","É","È","Ẻ","Ẽ","Ê","Ế","Ề","Ể","Ễ","Ệ",
           "Ộ","Ổ","Ỗ","Ố","Ồ","Ô","Ọ","Ó","Ò","Ỏ","Õ","Ơ","Ợ","Ớ","Ờ","Ở","Ỡ",
           "Ụ","Ư","Ứ","Ừ","Ử","Ữ","Ự","Ú","Ù","Ủ","Ũ",
           "Ị","Í","Ì","Ỉ","Ĩ","Y","Ý","Ỳ","Ỷ","Ỹ","Ỵ",
           "Đ",
           "A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q",
           "R","S","T","U","V","W","X","Y","Z"
           );

    protected $_utf8_lower = array(
           "ạ","á","à","ả","ã","â","ậ","ấ","ầ","ẩ","ẫ","ă","ặ","ắ","ằ","ẳ","ẵ",
           "ẹ","é","è","ẻ","ẽ","ê","ế","ề","ể","ễ","ệ",
           "ộ","ổ","ỗ","ố","ồ","ô","ọ","ó","ò","ỏ","õ","ơ","ợ","ớ","ờ","ở","ỡ",
           "ụ","ư","ứ","ừ","ử","ữ","ự","ú","ù","ủ","ũ",
           "ị","í","ì","ỉ","ĩ","y","ý","ỳ","ỷ","ỹ","ỵ",
           "đ",
           "a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q",
           "r","s","t","u","v","w","x","y","z"
           );

    protected $_ascii= array(
           "a","a","a","a","a","A","A","A","A","A",
           "a","a","a","a","a","a","A","A","A","A","A","A",
           "a","a","a","a","a","a","A","A","A","A","A","A",
           "e","e","e","e","e","e","E","E","E","E","E","E",
           "e","e","e","e","e","E","E","E","E","E",
           "o","o","o","o","o","o","O","O","O","O","O","O","O","o",
           "o","o","o","o","O","O","O","O",
           "o","o","o","o","o","o",
           "O","O","O","O","O","O",
           "u","u","u","u","u","u","u","U","U","U","U","U","U","U",
           "u","u","u","u","U","U","U","U",
           "i","i","i","i","i","I","I","I","I","I",
           "y","y","y","y","y","Y","Y","Y","Y","Y",
           "d","D"
           );
           
    protected $_viqr= array(
           "a.","a'","a`","a?","a~","A.","A'","A`","A?","A~",
           "a^","a^.","a^'","a^`","a^?","a^~","A^","A^.","A^'","A^`","A^?","A^~",
           "a(","a(.","a('","a(`","a(?","a^~","A(","A('","A(`","A(?","A(~","A(.",
           "e^","e.","e'","e`","e?","e~","E^","E.","E'","E`","E?","E~",
           "e^'","e^`","e^?","e^~","e^.","E^'","E^`","E^?","E^~","E^.",
           "o.","o^.","o^?","o^~","o^'","o^`","O.","O^.","O^?","O^~","O^'","O^`","O^","o^",
           "o'","o`","o?","o~","O'","O`","O?","O~",
           "o+","o+.","o+'","o+`","o+?","o+~",
           "O+","O+.","O+'","O+`","O+?","O+~",
           "u.","u+","u+'","u+`","u+?","u+~","U.","U+","U+'","U+`","U+?","U+~",
           "u'","u`","u?","u~","U'","U`","U?","U~",
           "i.","i'","i`","i?","i~","I.","I'","I`","I?","I~",
           "y.","y'","y`","y?","y~","Y.","Y'","Y`","Y?","Y~",
           "dd","DD"
           );
    
    protected $_iso88591 = array(

           "&#7841;","&#225;","&#224;","&#7843;","&#227;","&#7840;","&#193;","&#192;","&#7842;","&#195;",
           "&#226;","&#7853;","&#7845;","&#7847;","&#7849;","&#7851;","&#194;","&#7852;","&#7844;","&#7846;","&#7848;","&#7850;",
           "&#259;","&#7863;","&#7855;","&#7857;","&#7859;","&#7851;","&#258;","&#7854;","&#7856;","&#7858;","&#7860;","&#7862;",
           "&#234;","&#7865;","&#233;","&#232;","&#7867;","&#7869;","&#202;","&#7864;","&#201;","&#200;","&#7866;","&#7868;",
           "&#7871;","&#7873;","&#7875;","&#7877;","&#7879;","&#7870;","&#7872;","&#7874;","&#7876;","&#7878;",
           "&#7885;","&#7897;","&#7893;","&#7895;","&#7889;","&#7891;","&#7884;","&#7896;","&#7892;","&#7894;","&#7888;","&#7890;","&#212;","&#244;",
           "&#243;","&#242;","&#7887;","&#245;","&#7888;","&#212;","&#7886;","&#213;",
           "&#417;","&#7907;","&#7899;","&#7901;","&#7903;","&#7905;",
           "&#416;","&#7906;","&#7898;","&#7900;","&#7902;","&#7904;",
           "&#7909;","&#432;","&#7913;","&#7915;","&#7917;","&#7919;","&#7908;","&#431;","&#7912;","&#7914;","&#7916;","&#7918;",
           "&#250;","&#249;","&#7911;","&#361;","&#218;","&#217;","&#7910;","&#360;",
           "&#7883;","&#237;","&#236;","&#7881;","&#297;","&#7882;","&#205;","&#204;","&#7880;","&#296;",
           "&#7925;","&#253;","&#7923;","&#7927;","&#7929;","&#7924;","&#221;","&#7922;","&#7926;","&#7928;",
           "&#273;","&#272;"
           );
	
    public function setString($str){
    	$this->str =  $str;
    	return $this;
    }
    
	public function setOverlap($ishow){
    	$this->_ishow =  $ishow;
    	return $this;
    }
    
	public function convertUTF8ToASCII(){
	
		if($this->str){
			$value =  str_replace($this->_utf8,$this->_ascii,$this->str);
			if($value == $this->str && $this->_ishow){
				return $value;
			}else{
				if($value != $this->str)
					return $value;
			}
		}
		return false;
	}

        public function strToUpperUtf8(){

            if($this->str){
                    $value =  str_replace($this->_utf8_lower,$this->_utf8_upper,$this->str);
                    if($value == $this->str && $this->_ishow){
                        return $value;
                    }else{
                        if($value != $this->str)
                            return $value;
                    }
            }
            return false;
	}
}